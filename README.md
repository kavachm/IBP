This code is the MATLAB implementation of the single-frame
